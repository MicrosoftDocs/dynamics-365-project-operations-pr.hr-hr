---
title: Konfiguriranje automatskog stvaranja predračuna
description: U ovoj temi nalaze se informacije o konfiguriranju automatskog stvaranja predračuna.
author: rumant
manager: Annbe
ms.date: 10/13/2020
ms.topic: article
ms.service: dynamics-365-customerservice
ms.reviewer: kfend
ms.author: rumant
ms.openlocfilehash: e146dd510b3795d52d164fc6acf8e5400ba11310
ms.sourcegitcommit: 11a61db54119503e82faec5f99c4273e8d1247e5
ms.translationtype: HT
ms.contentlocale: hr-HR
ms.lasthandoff: 10/16/2020
ms.locfileid: "4073297"
---
# <a name="configure-automated-proforma-invoice-creation"></a><span data-ttu-id="d3213-103">Konfiguriranje automatskog stvaranja predračuna</span><span class="sxs-lookup"><span data-stu-id="d3213-103">Configure automated proforma invoice creation</span></span>

<span data-ttu-id="d3213-104">_**Odnosi se na:** Jednostavno uvođenje – od sklapanja posla do predračuna_</span><span class="sxs-lookup"><span data-stu-id="d3213-104">_**Applies To:** Lite deployment - deal to proforma invoicing_</span></span>

<span data-ttu-id="d3213-105">Možete konfigurirati automatsko stvaranje faktura u programu Dynamics 365 Project Operations.</span><span class="sxs-lookup"><span data-stu-id="d3213-105">You can configure automatic invoice creation in Dynamics 365 Project Operations.</span></span> <span data-ttu-id="d3213-106">Sustav stvara nacrt predračuna na temelju rasporeda faktura za svaki ugovor o projektu i redak ugovora.</span><span class="sxs-lookup"><span data-stu-id="d3213-106">The system creates a draft proforma invoice based on the invoice schedule for each project contract and contract line.</span></span> <span data-ttu-id="d3213-107">Rasporedi faktura konfigurirani su na razini retka ugovora.</span><span class="sxs-lookup"><span data-stu-id="d3213-107">Invoice schedules are configured at the contract line level.</span></span> <span data-ttu-id="d3213-108">Svaki redak ugovora može imati različit raspored faktura ili isti raspored faktura može biti uključen u svaki redak ugovora.</span><span class="sxs-lookup"><span data-stu-id="d3213-108">Each line on a contract can have a distinct invoice schedule, or the same invoice schedule can be included on every line of the contract.</span></span>

<span data-ttu-id="d3213-109">Kada stvarate fakturu, sustav uvijek stvara barem jednu fakturu po ugovoru o projektu.</span><span class="sxs-lookup"><span data-stu-id="d3213-109">When you create an invoice, the system always creates at least one invoice per project contract.</span></span> <span data-ttu-id="d3213-110">U nekim slučajevima može biti stvoreno više faktura.</span><span class="sxs-lookup"><span data-stu-id="d3213-110">In some cases, there may be multiple invoices created.</span></span>

<span data-ttu-id="d3213-111">Na primjer, ako ugovor ima više klijenata, stvorit će se onoliki broj računa koliko ima klijenata koji imaju naplative transakcije za fakturiranje na tom ugovoru o projektu.</span><span class="sxs-lookup"><span data-stu-id="d3213-111">For example, if the contract has multiple customers, the same number of invoices will be created as the number of customers that have billable transactions to invoice on that project contract.</span></span>

## <a name="understand-how-transactions-are-included-on-an-invoice"></a><span data-ttu-id="d3213-112">Razumijevanje načina uključivanja transakcija u račun</span><span class="sxs-lookup"><span data-stu-id="d3213-112">Understand how transactions are included on an invoice</span></span> 

<span data-ttu-id="d3213-113">Ponekad svaki redak ugovora koji se temelji na projektu navodi zaseban raspored faktura.</span><span class="sxs-lookup"><span data-stu-id="d3213-113">Sometimes, each project-based contract line specifies a separate invoice schedule.</span></span> <span data-ttu-id="d3213-114">Na primjer, usluge implementacije iz ugovora Adatum imaju sljedeće retke ugovora:</span><span class="sxs-lookup"><span data-stu-id="d3213-114">For example, implementation services for the Adatum contract have the following contract lines:</span></span>

- <span data-ttu-id="d3213-115">Prototip rada koji je fiksna cijena s dvije ručno stvorene kontrolne točke.</span><span class="sxs-lookup"><span data-stu-id="d3213-115">Prototype work that is a fixed price with two manually created milestones.</span></span>
- <span data-ttu-id="d3213-116">Posao implementacije koji uključuje Vrijeme i koji će se naplaćivati ponedjeljkom svaka dva tjedna.</span><span class="sxs-lookup"><span data-stu-id="d3213-116">Implementation work that includes Time and will be billed bi-weekly on Mondays.</span></span>
- <span data-ttu-id="d3213-117">Nastali troškovi koji se trebaju naplaćivati mjesečno prvog ponedjeljka u mjesecu.</span><span class="sxs-lookup"><span data-stu-id="d3213-117">Expenses incurred that need to be billed monthly on the first Monday of each month.</span></span>

<span data-ttu-id="d3213-118">Rasporedi faktura definirani za svaku od ove dvije stavke retka izgledaju kao sljedeća tablica:</span><span class="sxs-lookup"><span data-stu-id="d3213-118">Invoice schedules defined on each of these two line items look like the following table:</span></span>

| <span data-ttu-id="d3213-119">Redak ugovora</span><span class="sxs-lookup"><span data-stu-id="d3213-119">Contract line</span></span> | <span data-ttu-id="d3213-120">Datum izrade fakture</span><span class="sxs-lookup"><span data-stu-id="d3213-120">Invoice run date</span></span> | <span data-ttu-id="d3213-121">Datum završetka transakcije</span><span class="sxs-lookup"><span data-stu-id="d3213-121">Transaction cut-off date</span></span> | <span data-ttu-id="d3213-122">Datum kontrolne točke</span><span class="sxs-lookup"><span data-stu-id="d3213-122">Milestone date</span></span> | <span data-ttu-id="d3213-123">Iznos kontrolne točke</span><span class="sxs-lookup"><span data-stu-id="d3213-123">Milestone amount</span></span> |
| --- | --- | --- | --- | --- |
| <span data-ttu-id="d3213-124">Prototip rada</span><span class="sxs-lookup"><span data-stu-id="d3213-124">Prototype work</span></span> | <span data-ttu-id="d3213-125">Ponedjeljak, 5. listopada</span><span class="sxs-lookup"><span data-stu-id="d3213-125">October 5, Monday</span></span> | - | <span data-ttu-id="d3213-126">Ponedjeljak, 5. listopada</span><span class="sxs-lookup"><span data-stu-id="d3213-126">October 5, Monday</span></span> | <span data-ttu-id="d3213-127">5000 USD</span><span class="sxs-lookup"><span data-stu-id="d3213-127">5000 USD</span></span> |
| - | <span data-ttu-id="d3213-128">Utorak, 3. studenog</span><span class="sxs-lookup"><span data-stu-id="d3213-128">November 3, Tuesday</span></span> | - | <span data-ttu-id="d3213-129">Utorak, 3. studenog</span><span class="sxs-lookup"><span data-stu-id="d3213-129">November 3, Tuesday</span></span> | <span data-ttu-id="d3213-130">12,000 USD</span><span class="sxs-lookup"><span data-stu-id="d3213-130">12,000 USD</span></span> |
| <span data-ttu-id="d3213-131">Rad na implementaciji</span><span class="sxs-lookup"><span data-stu-id="d3213-131">Implementation work</span></span> | <span data-ttu-id="d3213-132">Ponedjeljak, 5. listopada</span><span class="sxs-lookup"><span data-stu-id="d3213-132">October 5, Monday</span></span> | <span data-ttu-id="d3213-133">Nedjelja, 4. listopada</span><span class="sxs-lookup"><span data-stu-id="d3213-133">October 4, Sunday</span></span> | - | - |
| - | <span data-ttu-id="d3213-134">Ponedjeljak, 19. listopada</span><span class="sxs-lookup"><span data-stu-id="d3213-134">October 19, Monday</span></span> | <span data-ttu-id="d3213-135">Nedjelja, 18. listopada</span><span class="sxs-lookup"><span data-stu-id="d3213-135">October 18, Sunday</span></span> | - | - |
| - | <span data-ttu-id="d3213-136">Ponedjeljak, 2. studenog</span><span class="sxs-lookup"><span data-stu-id="d3213-136">November 2, Monday</span></span> | <span data-ttu-id="d3213-137">Nedjelja, 1. studeni</span><span class="sxs-lookup"><span data-stu-id="d3213-137">November 1, Sunday</span></span> | - | - |
| - | <span data-ttu-id="d3213-138">Ponedjeljak, 16. studeni</span><span class="sxs-lookup"><span data-stu-id="d3213-138">November 16, Monday</span></span> | <span data-ttu-id="d3213-139">Nedjelja, 15. studeni</span><span class="sxs-lookup"><span data-stu-id="d3213-139">November 15, Sunday</span></span> | - | - |
| <span data-ttu-id="d3213-140">Nastali troškovi</span><span class="sxs-lookup"><span data-stu-id="d3213-140">Expenses incurred</span></span> | <span data-ttu-id="d3213-141">Ponedjeljak, 5. listopada</span><span class="sxs-lookup"><span data-stu-id="d3213-141">October 5, Monday</span></span> | <span data-ttu-id="d3213-142">Nedjelja, 4. listopada</span><span class="sxs-lookup"><span data-stu-id="d3213-142">October 4, Sunday</span></span> | - | - |
| - | <span data-ttu-id="d3213-143">Ponedjeljak, 2. studenog</span><span class="sxs-lookup"><span data-stu-id="d3213-143">November 2, Monday</span></span> | <span data-ttu-id="d3213-144">Nedjelja, 1. studeni</span><span class="sxs-lookup"><span data-stu-id="d3213-144">November 1, Sunday</span></span> | - | - |

<span data-ttu-id="d3213-145">U ovom primjeru, kada se automatsko fakturiranje pokreće dana:</span><span class="sxs-lookup"><span data-stu-id="d3213-145">In this example when the automatic invoicing runs on:</span></span>

- <span data-ttu-id="d3213-146">**4. listopada ili neki datum prije** : Za ovaj se ugovor ne generira faktura jer tablica **Raspored fakture** za svaki od ovih redaka ugovora ne poziva 4. listopada, nedjelju kao datum pokretanja fakture.</span><span class="sxs-lookup"><span data-stu-id="d3213-146">**October 4 or any date before** : No invoice is generated for this contract because the **Invoice Schedule** table for each of these contract lines doesn't call out October 4, Sunday as an invoice run date.</span></span>
- <span data-ttu-id="d3213-147">**Ponedjeljak, 5. listopada** : Generira se jedna faktura za:</span><span class="sxs-lookup"><span data-stu-id="d3213-147">**October 5 Monday** : One invoice is generated for:</span></span>

    - <span data-ttu-id="d3213-148">Prototip rada koji uključuje kontrolnu točku, ako je označena kao **Spremno za fakturiranje**.</span><span class="sxs-lookup"><span data-stu-id="d3213-148">Prototype work that includes the milestone, if it is marked as **Ready to Invoice**.</span></span>
    - <span data-ttu-id="d3213-149">Rad na implementaciji koji uključuje sve vremenske transakcije stvorene prije datuma presijecanja transakcija, nedjelja, 4. listopada, koji je označen kao **Spremno za fakturiranje**.</span><span class="sxs-lookup"><span data-stu-id="d3213-149">Implementation work that includes all Time transactions created before the transaction cut-off date of October 4, Sunday, that is marked as **Ready to Invoice**.</span></span>
    - <span data-ttu-id="d3213-150">Nastali trošak koji uključuje sve transakcije troškova stvorenih prije datuma presijecanja transakcija, nedjelja, 4. listopada, koji je označen kao **Spremno za fakturiranje**.</span><span class="sxs-lookup"><span data-stu-id="d3213-150">Expense incurred that includes all Expense transactions created before the transaction cut-off date of October 4, Sunday, that is marked as **Ready to Invoice**.</span></span>
  
- <span data-ttu-id="d3213-151">**6. listopada ili neki datum prije 19. listopada** : Za ovaj se ugovor ne generira faktura jer tablica **Raspored faktura** za svaki od ovih redaka ugovora ne poziva 6. listopada ili neki datum prije 19. listopada kao datum pokretanja fakture.</span><span class="sxs-lookup"><span data-stu-id="d3213-151">**On October 6 or any date before October 19** : No invoice is generated for this contract since the **Invoice Schedule** table for each of these contract lines does not call out October 6 or any date before October 19 as an invoice run date.</span></span>
- <span data-ttu-id="d3213-152">**19. listopad, ponedjeljak** : Jedna je faktura generirana za rad na implementaciji koji uključuje sve vremenske transakcije stvorene prije datuma presijecanja transakcija, 18. listopada, nedjelja, koji je označen kao **Spremno za fakturiranje**.</span><span class="sxs-lookup"><span data-stu-id="d3213-152">**October 19, Monday** : One invoice is generated for implementation work that includes all Time transactions created before the transaction cut-off date of October 18, Sunday, that is marked as **Ready to Invoice**.</span></span>
- <span data-ttu-id="d3213-153">**Ponedjeljak, 2. listopada** : Generira se jedna faktura za:</span><span class="sxs-lookup"><span data-stu-id="d3213-153">**November 2 Monday** : One invoice is generated for:</span></span>

    - <span data-ttu-id="d3213-154">Rad na implementaciji koji uključuje sve vremenske transakcije stvorene prije datuma presijecanja transakcija, nedjelja, 1. studeni, koji je označen kao **Spremno za fakturiranje**.</span><span class="sxs-lookup"><span data-stu-id="d3213-154">Implementation work that includes all Time transactions created before the transaction cut-off date of November 1, Sunday, that is marked as **Ready to Invoice**.</span></span>
    - <span data-ttu-id="d3213-155">Nastali trošak koji uključuje sve transakcije troškova stvorenih prije datuma presijecanja transakcija, nedjelja, 1. studeni, koji je označen kao **Spremno za fakturiranje**.</span><span class="sxs-lookup"><span data-stu-id="d3213-155">Expense incurred that includes all Expense transactions created before the transaction cut-off date of November 1, Sunday, that is marked as **Ready to Invoice**.</span></span>

- <span data-ttu-id="d3213-156">**Utorak, 3. studenog** : Generira se jedna faktura za rad na prototipu koji uključuje kontrolnu točku za 12.000 USD, ako je označena kao **Spremno za fakturiranje**.</span><span class="sxs-lookup"><span data-stu-id="d3213-156">**November 3, Tuesday** : One invoice is generated for prototype work that includes the milestone for 12000 USD, if it is marked as **Ready to Invoice**.</span></span>

## <a name="configure-automatic-invoicing"></a><span data-ttu-id="d3213-157">Konfiguriranje automatskog fakturiranja</span><span class="sxs-lookup"><span data-stu-id="d3213-157">Configure automatic invoicing</span></span>

<span data-ttu-id="d3213-158">Poduzmite sljedeće korake za konfiguraciju automatskog pokretanja faktura.</span><span class="sxs-lookup"><span data-stu-id="d3213-158">Complete the following steps to configure an automated invoice run.</span></span>

1. <span data-ttu-id="d3213-159">U stavci **Projektne operacije** idite na **Postavke** > **Ponavljanje postavljanja fakture**.</span><span class="sxs-lookup"><span data-stu-id="d3213-159">In **Project Operations** , go to **Settings** > **Recurring Invoice Setup**.</span></span>
2. <span data-ttu-id="d3213-160">Stvorite skupni posao i dodijelite mu naziv **Fakture stvorene u aplikacije Project Operations**.</span><span class="sxs-lookup"><span data-stu-id="d3213-160">Create a batch job, and name it **rPoject Operations Create Invoices**.</span></span> <span data-ttu-id="d3213-161">Naziv skupnog posla mora sadržavati riječi „stvaranje faktura”.</span><span class="sxs-lookup"><span data-stu-id="d3213-161">The name of the batch job must include the words, "create invoices".</span></span>
3. <span data-ttu-id="d3213-162">U polju **Vrsta posla** odaberite **Ništa**.</span><span class="sxs-lookup"><span data-stu-id="d3213-162">In the **Job Type** field, select **None**.</span></span> <span data-ttu-id="d3213-163">Prema zadanim postavkama polja **Dnevna učestalost** i **Aktivno je** postavljena su na **Da**.</span><span class="sxs-lookup"><span data-stu-id="d3213-163">By default, the **Frequency Daily** and **Is Active** fields are set to **Yes**.</span></span>
4. <span data-ttu-id="d3213-164">Odaberite **Pokreni tijek rada**.</span><span class="sxs-lookup"><span data-stu-id="d3213-164">Select **Run Workflow**.</span></span> <span data-ttu-id="d3213-165">U dijaloškom okviru **Pretraživanje zapisa** vidjet ćete tri tijeka rada:</span><span class="sxs-lookup"><span data-stu-id="d3213-165">In the **Look Up Record** dialog box, you will see three workflows:</span></span>

- <span data-ttu-id="d3213-166">ProcessRunCaller</span><span class="sxs-lookup"><span data-stu-id="d3213-166">ProcessRunCaller</span></span>
- <span data-ttu-id="d3213-167">ProcessRunner</span><span class="sxs-lookup"><span data-stu-id="d3213-167">ProcessRunner</span></span>
- <span data-ttu-id="d3213-168">UpdateRoleUtilization</span><span class="sxs-lookup"><span data-stu-id="d3213-168">UpdateRoleUtilization</span></span>

5. <span data-ttu-id="d3213-169">Odaberite **ProcessRunCaller** , a zatim **Dodaj**.</span><span class="sxs-lookup"><span data-stu-id="d3213-169">Select **ProcessRunCaller** , and then select **Add**.</span></span>
6. <span data-ttu-id="d3213-170">U sljedećem dijaloškom okviru odaberite **U redu**.</span><span class="sxs-lookup"><span data-stu-id="d3213-170">In the next dialog box, select **OK**.</span></span> <span data-ttu-id="d3213-171">Nakon tijeka rada **Sleep** slijedi tijek rada **Process**.</span><span class="sxs-lookup"><span data-stu-id="d3213-171">A **Sleep** workflow is followed by a **Process** workflow.</span></span> 

> [!NOTE]
> <span data-ttu-id="d3213-172">U petom koraku možete odabrati i **ProcessRunner**.</span><span class="sxs-lookup"><span data-stu-id="d3213-172">You can also select **ProcessRunner** in step 5.</span></span> <span data-ttu-id="d3213-173">Zatim, kada odaberete **U redu** , nakon tijeka rada **Process** slijedi tijek rada **Sleep**.</span><span class="sxs-lookup"><span data-stu-id="d3213-173">Then, when you select **OK** , a **Process** workflow is followed by a **Sleep** workflow.</span></span>

<span data-ttu-id="d3213-174">Tijekovi rada **ProcessRunCaller** i **ProcessRunner** stvaraju fakture.</span><span class="sxs-lookup"><span data-stu-id="d3213-174">The **ProcessRunCaller** and **ProcessRunner** workflows create invoices.</span></span> <span data-ttu-id="d3213-175">**ProcessRunCaller** poziva **ProcessRunner**.</span><span class="sxs-lookup"><span data-stu-id="d3213-175">**ProcessRunCaller** calls **ProcessRunner**.</span></span> <span data-ttu-id="d3213-176">**ProcessRunner** jest tijek rada koji stvara fakture.</span><span class="sxs-lookup"><span data-stu-id="d3213-176">**ProcessRunner** is the workflow that actually creates the invoices.</span></span> <span data-ttu-id="d3213-177">Radni tijek prolazi kroz sve retke ugovora za koje je potrebno stvoriti fakture i stvara fakture za te retke.</span><span class="sxs-lookup"><span data-stu-id="d3213-177">The workflow goes through all the contract lines that invoices must be created for, and creates invoices for those lines.</span></span> <span data-ttu-id="d3213-178">Da bi se odredili reci ugovora za koje je potrebno stvoriti fakture, posao traži datume stvaranja faktura za retke ugovora.</span><span class="sxs-lookup"><span data-stu-id="d3213-178">To determine the contract lines that invoices must be created for, the job looks at invoice run dates for the contract lines.</span></span> <span data-ttu-id="d3213-179">Ako reci ugovora koji pripadaju jednom ugovoru imaju isti datum stvaranja fakture, transakcije se kombiniraju u jednu fakturu koja ima dva retka fakture.</span><span class="sxs-lookup"><span data-stu-id="d3213-179">If contract lines that belong to one contract have the same invoice run date, the transactions are combined into one invoice that has two invoice lines.</span></span> <span data-ttu-id="d3213-180">Ako nema transakcija za stvaranje faktura, posao preskače stvaranje fakture.</span><span class="sxs-lookup"><span data-stu-id="d3213-180">If there are no transactions to create invoices for, the job skips creating an invoice.</span></span>

<span data-ttu-id="d3213-181">Nakon pokretanja funkcije **ProcessRunner** poziva se **ProcessRunCaller** , navodi se vrijeme završetka i funkcija se zatvara.</span><span class="sxs-lookup"><span data-stu-id="d3213-181">After **ProcessRunner** has finished running, it calls **ProcessRunCaller** , provides the end time, and is closed.</span></span> <span data-ttu-id="d3213-182">**ProcessRunCaller** zatim pokreće mjerač vremena koji se izvodi 24 sata od navedenog vremena završetka.</span><span class="sxs-lookup"><span data-stu-id="d3213-182">**ProcessRunCaller** then starts a timer that runs for 24-hours from the specified end time.</span></span> <span data-ttu-id="d3213-183">Po završetku izvođenja mjerača vremena funkcija **ProcessRunCaller** zatvara se.</span><span class="sxs-lookup"><span data-stu-id="d3213-183">At the end of the timer, **ProcessRunCaller** is closed.</span></span>

<span data-ttu-id="d3213-184">Skupni postupak stvaranja faktura ponavljajući je posao.</span><span class="sxs-lookup"><span data-stu-id="d3213-184">The batch process job for creating invoices is a recurrent job.</span></span> <span data-ttu-id="d3213-185">Ako se taj skupni postupak izvodi više puta, stvaraju se višestruke instance posla koje uzrokuju pogreške.</span><span class="sxs-lookup"><span data-stu-id="d3213-185">If this batch process is run many times, multiple instances of the job are created and causes errors.</span></span> <span data-ttu-id="d3213-186">Stoga biste trebali pokrenuti skupni postupak samo jednom i zatim ga ponovno pokrenuti samo ako se prestane izvoditi.</span><span class="sxs-lookup"><span data-stu-id="d3213-186">Therefore, you should start the batch process only one time, and then restart only if it stops running.</span></span>

> [!NOTE]
> <span data-ttu-id="d3213-187">Skupno fakturiranje u aplikaciji Project Operations izvršava se samo za retke ugovora o projektu koji su konfigurirani prema rasporedu faktura.</span><span class="sxs-lookup"><span data-stu-id="d3213-187">Batch invoicing in Project Operations only runs for project contract lines that are configured by invoice schedules.</span></span> <span data-ttu-id="d3213-188">Ugovorni redci s načinom naplate fiksne cijene moraju imati konfigurirane prekretnice.</span><span class="sxs-lookup"><span data-stu-id="d3213-188">A contract line with a fixed price billing method must have milestones configured.</span></span> <span data-ttu-id="d3213-189">Redak projektnog ugovora s vremenskim i materijalnim načinom naplate treba imati postavku rasporeda računa na temelju datuma.</span><span class="sxs-lookup"><span data-stu-id="d3213-189">A project contract line with a time and material billing method will need a date-based invoice schedule set up.</span></span>
